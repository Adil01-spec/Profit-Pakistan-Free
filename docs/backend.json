{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile within the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the UserProfile entity."
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "isAdmin": {
          "type": "boolean",
          "description": "Flag indicating whether the user is an administrator."
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "isAdmin"
      ]
    },
    "Report": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Report",
      "type": "object",
      "description": "Represents a product launch or ad feasibility analysis report.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Report entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N Report). The ID of the user who created this report."
        },
        "productName": {
          "type": "string",
          "description": "Name of the product being analyzed."
        },
        "category": {
          "type": "string",
          "description": "Category of the product."
        },
        "date": {
          "type": "string",
          "description": "Date and time the report was generated.",
          "format": "date-time"
        },
        "type": {
          "type": "string",
          "description": "Type of analysis: 'Launch' or 'Feasibility'."
        },
        "results": {
          "type": "string",
          "description": "JSON string representing the analysis results."
        }
      },
      "required": [
        "id",
        "userId",
        "productName",
        "category",
        "date",
        "type",
        "results"
      ]
    },
    "CourierRate": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CourierRate",
      "type": "object",
      "description": "Represents courier rates for COD and Non-COD shipments.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the CourierRate entity."
        },
        "courier": {
          "type": "string",
          "description": "Name of the courier company."
        },
        "cod": {
          "type": "number",
          "description": "Rate for Cash on Delivery (COD) shipments."
        },
        "nonCod": {
          "type": "number",
          "description": "Rate for Non-Cash on Delivery shipments."
        }
      },
      "required": [
        "id",
        "courier",
        "cod",
        "nonCod"
      ]
    },
    "FbrRate": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FbrRate",
      "type": "object",
      "description": "Represents FBR tax percentages for COD and Non-COD transactions.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the FbrRate entity."
        },
        "cod": {
          "type": "number",
          "description": "Tax percentage for Cash on Delivery (COD) transactions."
        },
        "nonCod": {
          "type": "number",
          "description": "Tax percentage for Non-Cash on Delivery transactions."
        },
        "lastUpdated": {
          "type": "string",
          "description": "Date the tax rates were last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "cod",
        "nonCod",
        "lastUpdated"
      ]
    },
    "BankFee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "BankFee",
      "type": "object",
      "description": "Represents international card transaction fees for different banks.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the BankFee entity."
        },
        "bank": {
          "type": "string",
          "description": "Name of the bank."
        },
        "feePercent": {
          "type": "number",
          "description": "Percentage fee charged for international card transactions."
        }
      },
      "required": [
        "id",
        "bank",
        "feePercent"
      ]
    },
    "ShopifyPlan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ShopifyPlan",
      "type": "object",
      "description": "Represents Shopify plan pricing data.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ShopifyPlan entity."
        },
        "plan": {
          "type": "string",
          "description": "Name of the Shopify plan (e.g., 'Basic', 'Regular')."
        },
        "costPerMonth": {
          "type": "number",
          "description": "Monthly cost of the Shopify plan in USD."
        }
      },
      "required": [
        "id",
        "plan",
        "costPerMonth"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information, including the 'isAdmin' flag for authorization. The 'isAdmin' flag is denormalized here to make access control more efficient (Authorization Independence).",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/reports/{reportId}",
        "definition": {
          "entityName": "Report",
          "schema": {
            "$ref": "#/backend/entities/Report"
          },
          "description": "Stores user-generated reports. Access is restricted to the owning user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "reportId",
              "description": "The unique identifier for the report."
            }
          ]
        }
      },
      {
        "path": "/courierRates/{courierRateId}",
        "definition": {
          "entityName": "CourierRate",
          "schema": {
            "$ref": "#/backend/entities/CourierRate"
          },
          "description": "Stores courier rates managed by admins.",
          "params": [
            {
              "name": "courierRateId",
              "description": "The unique identifier for the courier rate."
            }
          ]
        }
      },
      {
        "path": "/fbrRates/{fbrRateId}",
        "definition": {
          "entityName": "FbrRate",
          "schema": {
            "$ref": "#/backend/entities/FbrRate"
          },
          "description": "Stores FBR tax rates managed by admins.",
          "params": [
            {
              "name": "fbrRateId",
              "description": "The unique identifier for the FBR rate."
            }
          ]
        }
      },
      {
        "path": "/bankFees/{bankFeeId}",
        "definition": {
          "entityName": "BankFee",
          "schema": {
            "$ref": "#/backend/entities/BankFee"
          },
          "description": "Stores bank fees managed by admins.",
          "params": [
            {
              "name": "bankFeeId",
              "description": "The unique identifier for the bank fee."
            }
          ]
        }
      },
      {
        "path": "/shopifyPlans/{shopifyPlanId}",
        "definition": {
          "entityName": "ShopifyPlan",
          "schema": {
            "$ref": "#/backend/entities/ShopifyPlan"
          },
          "description": "Stores Shopify plan data managed by admins.",
          "params": [
            {
              "name": "shopifyPlanId",
              "description": "The unique identifier for the Shopify plan."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support an admin management system for Profit Pakistan Pro, focusing on secure data access and role-based authorization. It leverages structural segregation and denormalization to achieve authorization independence and simplify security rules. The core principle is to separate user-specific data from admin-managed settings and rates, ensuring that users can only access their own reports while admins have broader access to configuration data. Authorization Independence is achieved by storing the `isAdmin` flag directly within the user profile, eliminating the need for `get()` calls in security rules to determine admin status. This allows for atomic operations and easier debugging.\n\nQAPs (Rules are not Filters) are supported through structural segregation. User reports are stored under `/users/{userId}/reports/{reportId}`, which allows secure `list` operations for a specific user's reports using path-based rules. Admin-managed data, such as courier rates and FBR rates, are stored in separate collections at the root level (e.g., `/courierRates/{courierRateId}`), enabling admins to `list`, `read`, `write`, and `delete` these settings without affecting user data access. These top-level collections are protected by checking the `isAdmin` status in the security rules. Finally, the Membership Map is not required, because the administrative data does not require collaborative access."
  }
}